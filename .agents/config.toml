# =============================================================================
# Claude Flow V3 - Codex Configuration
# =============================================================================
# Generated by: @claude-flow/codex
# Documentation: https://github.com/ruvnet/claude-flow
# 
# This file configures the Codex CLI for Claude Flow integration.
# Place in .agents/config.toml (project) or .codex/config.toml (user).
# =============================================================================

# =============================================================================
# Core Settings
# =============================================================================

# Model selection - the AI model to use for code generation
# Options: gpt-5.3-codex, gpt-4o, claude-sonnet, claude-opus
model = "gpt-5.3-codex"

# Approval policy determines when human approval is required
# - untrusted: Always require approval
# - on-failure: Require approval only after failures
# - on-request: Require approval for significant changes
# - never: Auto-approve all actions (use with caution)
approval_policy = "on-request"

# Sandbox mode controls file system access
# - read-only: Can only read files, no modifications
# - workspace-write: Can write within workspace directory
# - danger-full-access: Full file system access (dangerous)
sandbox_mode = "workspace-write"

# Web search enables internet access for research
# - disabled: No web access
# - cached: Use cached results when available
# - live: Always fetch fresh results
web_search = "cached"

# =============================================================================
# Project Documentation
# =============================================================================

# Maximum bytes to read from AGENTS.md files
project_doc_max_bytes = 65536

# Fallback filenames if AGENTS.md not found
project_doc_fallback_filenames = [
  "AGENTS.md",
  "TEAM_GUIDE.md",
  ".agents.md"
]

# =============================================================================
# Features
# =============================================================================

[features]
# Enable child AGENTS.md guidance
child_agents_md = true

# Cache shell environment for faster repeated commands
shell_snapshot = true

# Smart approvals based on request context
request_rule = true

# Enable remote compaction for large histories
remote_compaction = true

# =============================================================================
# MCP Servers
# =============================================================================

[mcp_servers.claude-flow]
command = "npx"
args = ["-y", "@claude-flow/cli@latest"]
enabled = true
tool_timeout_sec = 120

# =============================================================================
# Skills Configuration
# =============================================================================

[[skills.config]]
path = ".agents/skills/swarm-orchestration"
enabled = true

[[skills.config]]
path = ".agents/skills/memory-management"
enabled = true

[[skills.config]]
path = ".agents/skills/sparc-methodology"
enabled = true

[[skills.config]]
path = ".agents/skills/security-audit"
enabled = true

# =============================================================================
# Profiles
# =============================================================================

# Development profile - more permissive for local work
[profiles.dev]
approval_policy = "never"
sandbox_mode = "danger-full-access"
web_search = "live"

# Safe profile - maximum restrictions
[profiles.safe]
approval_policy = "untrusted"
sandbox_mode = "read-only"
web_search = "disabled"

# CI profile - for automated pipelines
[profiles.ci]
approval_policy = "never"
sandbox_mode = "workspace-write"
web_search = "cached"

# =============================================================================
# History
# =============================================================================

[history]
# Save all session transcripts
persistence = "save-all"

# =============================================================================
# Shell Environment
# =============================================================================

[shell_environment_policy]
# Inherit environment variables
inherit = "core"

# Exclude sensitive variables
exclude = ["*_KEY", "*_SECRET", "*_TOKEN", "*_PASSWORD"]

# =============================================================================
# Sandbox Workspace Write Settings
# =============================================================================

[sandbox_workspace_write]
# Additional writable paths beyond workspace
writable_roots = []

# Allow network access
network_access = true

# Exclude temp directories
exclude_slash_tmp = false

# =============================================================================
# Security Settings
# =============================================================================

[security]
# Enable input validation for all user inputs
input_validation = true

# Prevent directory traversal attacks
path_traversal_prevention = true

# Scan for hardcoded secrets
secret_scanning = true

# Scan dependencies for known CVEs
cve_scanning = true

# Maximum file size for operations (bytes)
max_file_size = 10485760

# Allowed file extensions (empty = allow all)
allowed_extensions = []

# Blocked file patterns (regex)
blocked_patterns = ["\\.env$", "credentials\\.json$", "\\.pem$", "\\.key$"]

# =============================================================================
# Performance Settings
# =============================================================================

[performance]
# Maximum concurrent agents
max_agents = 8

# Task timeout in seconds
task_timeout = 300

# Memory limit per agent
memory_limit = "512MB"

# Enable response caching
cache_enabled = true

# Cache TTL in seconds
cache_ttl = 3600

# Enable parallel task execution
parallel_execution = true

# =============================================================================
# Logging Settings
# =============================================================================

[logging]
# Log level: debug, info, warn, error
level = "info"

# Log format: json, text, pretty
format = "pretty"

# Log destination: stdout, file, both
destination = "stdout"

# =============================================================================
# Neural Intelligence Settings
# =============================================================================

[neural]
# Enable SONA (Self-Optimizing Neural Architecture)
sona_enabled = true

# Enable HNSW vector search
hnsw_enabled = true

# HNSW index parameters
hnsw_m = 16
hnsw_ef_construction = 200
hnsw_ef_search = 100

# Enable pattern learning
pattern_learning = true

# Learning rate for neural adaptation
learning_rate = 0.01

# =============================================================================
# Swarm Orchestration Settings
# =============================================================================

[swarm]
# Default topology: hierarchical, mesh, ring, star
default_topology = "hierarchical"

# Default strategy: balanced, specialized, adaptive
default_strategy = "specialized"

# Consensus algorithm: raft, byzantine, gossip
consensus = "raft"

# Enable anti-drift measures
anti_drift = true

# Checkpoint interval (tasks)
checkpoint_interval = 10

# =============================================================================
# Hooks Configuration
# =============================================================================

[hooks]
# Enable lifecycle hooks
enabled = true

# Pre-task hook
pre_task = true

# Post-task hook (for learning)
post_task = true

# Enable neural training on post-edit
train_on_edit = true

# =============================================================================
# Background Workers
# =============================================================================

[workers]
# Enable background workers
enabled = true

# Worker configuration
[workers.audit]
enabled = true
priority = "critical"
interval = 300

[workers.optimize]
enabled = true
priority = "high"
interval = 600

[workers.consolidate]
enabled = true
priority = "low"
interval = 1800
